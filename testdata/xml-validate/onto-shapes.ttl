@prefix knora-api:   <http://api.knora.org/ontology/knora-api/v2#> .
@prefix owl:         <http://www.w3.org/2002/07/owl#> .
@prefix rdf:         <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:        <http://www.w3.org/2000/01/rdf-schema#> .
@prefix salsah-gui:  <http://api.knora.org/ontology/salsah-gui/v2#> .
@prefix xsd:         <http://www.w3.org/2001/XMLSchema#> .
@prefix sh:          <http://www.w3.org/ns/shacl#> .

@prefix val-shapes:  <http://api.knora.org/val-shapes-shapes/v2#> .

@prefix onto:        <http://0.0.0.0:3333/ontology/9999/onto/v2#> .
@prefix onto-shapes: <http://0.0.0.0:3333/ontology/9999/onto-shapes/v2#> .


onto-shapes:NormalClass
  a                    sh:NodeShape ;
  sh:targetClass       onto:NormalClass ;
  sh:property          [
                         a           sh:PropertyShape ;
                         sh:path     onto:linkProp ;
                       ] , onto-shapes:linkProp_Shape ,
                       [
                         a           sh:PropertyShape ;
                         sh:path     onto:listProp ;
                       ] , onto-shapes:listProp_Shape ,
                       [
                         a           sh:PropertyShape ;
                         sh:path     onto:hasSimpleText ;
                       ] , onto-shapes:hasSimpleText_Shape ;
  sh:ignoredProperties ( rdf:type rdfs:label ) ;
  sh:closed            true .


onto-shapes:CardOneResource
  a                    sh:NodeShape ;
  sh:targetClass       onto:CardOneResource ;
  sh:property          [
                         a           sh:PropertyShape ;
                         sh:path     onto:hasSimpleText ;
                         sh:minCount 1 ;
                         sh:maxCount 1 ;
                         sh:severity sh:Violation ;
                         sh:message  "Cardinality: 'onto:hasSimpleText' -> exactly 1"
                       ] , onto-shapes:hasSimpleText_Shape ;
  sh:ignoredProperties ( rdf:type rdfs:label ) ;
  sh:closed            true .


onto-shapes:SubClass
  a                    sh:NodeShape ;
  sh:targetClass       onto:SubClass ;
  sh:property          [
                         a           sh:PropertyShape ;
                         sh:path     onto:hasSimpleText ;
                         sh:minCount 1 ;
                         sh:maxCount 1 ;
                         sh:severity sh:Violation ;
                         sh:message  "Cardinality: 'onto:hasSimpleText' -> exactly 1"
                       ] ;
  sh:ignoredProperties ( rdf:type rdfs:label ) ;
  sh:closed            true .


####################

onto-shapes:hasSimpleText_Shape
  a           sh:PropertyShape ;
  sh:message  "Object for: 'onto:hasSimpleText' -> must be a non-empty string." ;
  sh:path     onto:hasSimpleText ;
  sh:class    knora-api:TextValue ;
  sh:node     val-shapes:TextValue_Shape ;
  sh:severity sh:Violation .


####################

onto-shapes:listProp_Shape
  a                   sh:NodeShape ;
  sh:targetObjectsOf  onto:listProp ;
  sh:property         onto-shapes:listValueAsListNode_listProp, onto-shapes:hasListName_listProp .


onto-shapes:listValueAsListNode_listProp
  a           sh:PropertyShape ;
  sh:message  "object must be of type ListValue" ;
  sh:path     onto:listProp ;
  sh:class    knora-api:ListValue ;
  sh:severity sh:Violation .

onto-shapes:listValueAsListNode_listProp
  a           sh:PropertyShape ;
  sh:message  "the value of onto:listProp is invalid" ;
  sh:path     knora-api:listValueAsListNode ;
  sh:in       ( "n1" "n1.1" "n1.1.1" ) ;
  sh:severity sh:Violation .


onto-shapes:hasListName_listProp
  a           sh:PropertyShape ;
  sh:message  "the list name of onto:listProp is invalid" ;
  sh:path     val-shapes:hasListName ;
  sh:in       ( "onlyList" ) ;
  sh:severity sh:Violation .

####################

# TODO: check for value type
onto-shapes:linkProp_Shape
  a                   sh:NodeShape ;
  sh:targetObjectsOf  onto:linkProp ;
  sh:property         onto-shapes:linkValueHasTargetIri_linkProp ;
  sh:severity         sh:Violation .


onto-shapes:linkValueHasTargetIri_linkProp
  a           sh:PropertyShape ;
  sh:message  "object of linkProp be a a CardOneResource or a subclass of it." ;
  sh:path     knora-api:linkValueHasTargetIri ;
  sh:class    onto:CardOneResource ;
  sh:severity sh:Violation .
